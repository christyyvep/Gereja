<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unlock User Account</title>
</head>
<body>
    <h1>Unlock User Account - Emergency Tool</h1>
    
    <div>
        <h3>Unlock Specific User</h3>
        <input type="text" id="username" placeholder="Enter username (e.g., christy potabuga)" />
        <button onclick="unlockUser()">Unlock User</button>
    </div>
    
    <div>
        <h3>Reset All Lockouts</h3>
        <button onclick="resetAllLockouts()">Reset All User Lockouts</button>
    </div>
    
    <div id="results" style="margin-top: 20px; padding: 10px; background: #f0f0f0;">
        <p>Results will appear here...</p>
    </div>

    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.3.1/firebase-app.js'
        import { getFunctions, httpsCallable } from 'https://www.gstatic.com/firebasejs/10.3.1/firebase-functions.js'

        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyA3Rm_kfJo5QsmJCMfNJYdoV9CYfN9o4gE",
            authDomain: "myrajawali-app.firebaseapp.com",
            projectId: "myrajawali-app",
            storageBucket: "myrajawali-app.appspot.com",
            messagingSenderId: "1090503445464",
            appId: "1:1090503445464:web:7e50c38b29b1af47ce66eb"
        }

        // Initialize Firebase
        const app = initializeApp(firebaseConfig)
        const functions = getFunctions(app)

        // Global functions
        window.unlockUser = async function() {
            const username = document.getElementById('username').value.trim()
            const resultsDiv = document.getElementById('results')
            
            if (!username) {
                resultsDiv.innerHTML = '<p style="color: red;">Please enter a username</p>'
                return
            }

            try {
                resultsDiv.innerHTML = '<p>Unlocking user...</p>'
                
                const unlockUserFn = httpsCallable(functions, 'unlockUser')
                const result = await unlockUserFn({ username: username })
                
                resultsDiv.innerHTML = `
                    <p style="color: green;">✅ Success!</p>
                    <p>Message: ${result.data.message}</p>
                    <p>Timestamp: ${result.data.timestamp}</p>
                `
            } catch (error) {
                console.error('Error unlocking user:', error)
                resultsDiv.innerHTML = `
                    <p style="color: red;">❌ Error unlocking user</p>
                    <p>Error: ${error.message}</p>
                `
            }
        }

        window.resetAllLockouts = async function() {
            const resultsDiv = document.getElementById('results')
            
            try {
                resultsDiv.innerHTML = '<p>Resetting all lockouts...</p>'
                
                const resetAllLockoutsFn = httpsCallable(functions, 'resetAllLockouts')
                const result = await resetAllLockoutsFn()
                
                resultsDiv.innerHTML = `
                    <p style="color: green;">✅ Success!</p>
                    <p>Message: ${result.data.message}</p>
                    <p>Users unlocked: ${result.data.count || 0}</p>
                `
            } catch (error) {
                console.error('Error resetting lockouts:', error)
                resultsDiv.innerHTML = `
                    <p style="color: red;">❌ Error resetting lockouts</p>
                    <p>Error: ${error.message}</p>
                `
            }
        }
    </script>
</body>
</html>
